<h3 mat-dialog-title>{{ 'Upload excel file' | translate }}</h3>
<div mat-dialog-content class="">
  <div class="d-flex flex-row justify-content-start">
    <button
      mat-raised-button
      color="primary"
      *ngIf="xlsxEformsFileUploader?.queue?.length == 0"
      (click)="xlsxEforms.click()"
      [loading]="loaderService.isLoading | async"
    >
      {{ 'Upload' | translate }}
    </button>
    <button
      mat-raised-button
      color="warn"
      *ngIf="xlsxEformsFileUploader?.queue?.length > 0"
      (click)="xlsxEforms.click()"
      [loading]="loaderService.isLoading | async"
    >
      {{ 'Pending' | translate }}
    </button>
    <input
      type="file"
      ng2FileSelect
      (onFileSelected)="uploadExcelEformsFile()"
      [uploader]="xlsxEformsFileUploader"
      #xlsxEforms
      id="xlsxImportInput"
      style="display: none"
    />
  </div>
  <!--<div class="">
    <div style="width: 100%">
      {{ 'Uploading progress:' | translate }}
      <div class="progress">
        <div
          class="progress-bar"
          role="progressbar"
          [ngStyle]="{
                    width:
                      xlsxEformsFileUploader?.queue?.length !== 0
                        ? xlsxEformsFileUploader.progress + '%'
                        : ''
                  }"
        ></div>
      </div>
    </div>
  </div>-->
  <div class="p-1 mt-4 table-responsive no-gutters">
    <table
      mdbTable
      striped="true"
      hover="true"
      small="true"
      class="z-depth-1 text-center"
    >
      <thead>
      <tr>
        <th scope="col">
          {{ 'Column' | translate }}
        </th>
        <th scope="col">
          {{ 'Row' | translate }}
        </th>
        <th scope="col">
          {{ 'Error' | translate }}
        </th>
      </tr>
      </thead>
      <tbody id="tableBody">
      <tr *ngFor="let error of errors">
        <td id="errorColumn">
          {{ error.col }}
        </td>
        <td id="errorRow">
          {{ error.row }}
        </td>
        <td id="errorMessage">
          {{ error.message }}
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
<div mat-dialog-actions class="d-flex flex-row justify-content-end">
  <!--        <button-->
  <!--          mdbBtn-->
  <!--          class="btn-success btn-small-height"-->
  <!--          (click)="uploadExcelEformsFile()"-->
  <!--          id="uploadExcelEformsFileBtn"-->
  <!--        >-->
  <!--          {{ 'Upload' | translate }}-->
  <!--        </button>-->
  <button
    mat-raised-button
    (click)="excelEformsModal()"
  >
    {{ 'Close' | translate }}
  </button>
</div>

