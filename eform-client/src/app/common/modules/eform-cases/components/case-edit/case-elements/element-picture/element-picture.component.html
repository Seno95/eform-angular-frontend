<div class="row pl-2">
  <button
    mat-mini-fab
    color="primary"
    [disabled]="buttonsLocked"
    mdbTooltip="{{'Add new image' | translate}}"
    (click)="updateAddNewImageModal.show()"
  >
    <mat-icon>add</mat-icon>
  </button>
</div>
<div class="row">
  <div class="col-md-3 col-sm-4 col-xs-12" *ngFor="let image of images; let i = index">
    <mdb-card>
      <mdb-card-img (click)="openPicture(i)" [src]="image.src | authImage | async" alt="Card image cap"></mdb-card-img>
      <!--Card content-->
      <mdb-card-body>
        <mdb-card-text>
          <div class="d-flex justify-content-center">
            <button
              color="accent"
              mat-mini-fab
              mdbTooltip="{{'Rotate on 90' | translate}}"
              [disabled]="buttonsLocked"
              (click)="rotatePicture(image)">
              <mat-icon>redo</mat-icon>
            </button>
            <button
              color="warn"
              mat-mini-fab
              [disabled]="buttonsLocked"
              mdbTooltip="{{'Delete picture' | translate}}"
              (click)="imageForDelete = image; confirmDeleteImageModal.show()">
              <mat-icon>delete</mat-icon>
            </button>
            <button
              mat-mini-fab
              color="primary"
              [disabled]="!image.googleMapsLat && !image.googleMapsLon || buttonsLocked"
              mdbTooltip="{{'Open location' | translate}}"
              (click)="openGpsWindow(image.googleMapsUrl)"
            >
              <mat-icon>place</mat-icon>
            </button>
            <!--            <button mdbBtn class="btn btn-icon btn-success"-->
            <!--                    mdbTooltip="{{'Update image' | translate}}"-->
            <!--                    [disabled]="buttonsLocked"-->
            <!--                    (click)="imageIdForUpdate = image.uploadedObjId;updateAddNewImageModal.show()">-->
            <!--              <fa-icon icon="pen" size="lg" [fixedWidth]="true"></fa-icon>-->
            <!--            </button>-->
          </div>
        </mdb-card-text>
      </mdb-card-body>
    </mdb-card>
  </div>
</div>

<div mdbModal class="modal fade" #updateAddNewImageModal="mdbModal">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
        <h3>{{ 'Select new image' | translate }}</h3>
      </div>
      <div class="modal-body">
        <input
          type="file"
          hidden
          accept="image/*"
          (change)="onFileSelected($event)"
          id="imageInput"
          #fileUpload
        />
        <div>
          {{
          newImageForUpdate ? newImageForUpdate.name :
            'No file uploaded yet.' | translate
          }}
          <button
            mat-raised-button
            color="primary"
            (click)="fileUpload.click()"
          >
            {{ 'Select image' | translate }}
          </button>
        </div>
      </div>
      <div class="modal-footer d-flex justify-content-around">
        <button
          mat-raised-button
          color="accent"
          (click)="!!imageIdForUpdate ? updatePicture() : addPicture()"
          [disabled]="!newImageForUpdate">
          {{ (!!imageIdForUpdate ? 'Update' : 'Add') | translate }}
        </button>
        <button
          mat-raised-button
          (click)="imageIdForUpdate = undefined; updateAddNewImageModal.hide()">
          {{ 'Cancel' | translate }}
        </button>
      </div>
    </div>
  </div>
</div>

<div mdbModal class="modal fade" #confirmDeleteImageModal="mdbModal">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
        <h3>{{ 'Are you sure you want to delete' | translate }}?</h3>
      </div>
      <div class="modal-footer d-flex justify-content-around">
        <button
          mat-raised-button color="warn"
          (click)="deletePicture(imageForDelete)"
          [disabled]="!imageForDelete">
          {{ 'Delete' | translate }}
        </button>
        <button
          mat-raised-button
          (click)="imageForDelete = undefined; confirmDeleteImageModal.hide()">
          {{ 'Cancel' | translate }}
        </button>
      </div>
    </div>
  </div>
</div>
